<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="mystyle.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.4.3/css/ol.css" type="text/css">
        <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.4.3/build/ol.js"></script>
        <title>COVID19 Stats By Countries - Exercise 3 - Eric ROMANG</title>
    </head>
<body onload="downloadAndStore()">

<!--
<div id="DownloadAndStore">
<button type="button" onclick="downloadAndStore()">Download and store data</button>
</div>
-->

<script>
function downloadAndStore() {
    //var i;
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
          //document.getElementById("DownloadAndStore").innerHTML = this.responseText;

          var myArr = JSON.parse(this.responseText);
          //document.getElementById("DownloadAndStore").innerHTML = myArr[0];

          // Loop the JSON file
          //for (i in myArr) {
            //document.getElementById("DownloadAndStore").innerHTML += i + "<br>";
            //document.getElementById("DownloadAndStore").innerHTML += myArr[i].country + "<br>";
          //}
      
          // Storing data 
        var myJSON = JSON.stringify(myArr);
        localStorage.setItem("COVID_Stats_By_Countries", myJSON);

        // Display end
        //document.getElementById("DownloadAndStore").innerHTML += "Data downloaded and stored";
    }
  };
  xhttp.open("GET", "https://disease.sh/v3/covid-19/countries", true);
  xhttp.send();
}
</script>

<h1>COVID19 Stats By Countries - Exercise 3 - Eric ROMANG</h1>

<div id="map" class="map"></div>

<!--
<div id="LoadStoredData">
<button type="button" onclick="LoadStoredData()">Load stored data</button>
</div>

<script>
function LoadStoredData() {
    var i;
    data = localStorage.getItem("COVID_Stats_By_Countries");
    myArr = JSON.parse(data);

    // Loop the JSON file
    for (i in myArr) {
        //document.getElementById("LoadStoredData").innerHTML += x + "<br>";
        document.getElementById("LoadStoredData").innerHTML += myArr[i].country + "<br>";
    }
    //document.getElementById("LoadStoredData").innerHTML = obj.name;

    // Display end
    document.getElementById("LoadStoredData").innerHTML += "Stored data loaded";
}
</script>
-->

<script type="text/javascript">
    var map = new ol.Map({
      target: 'map',
      layers: [
        new ol.layer.Tile({
          source: new ol.source.OSM()
        }) 
      ],
      view: new ol.View({
        //center: ol.proj.fromLonLat([37.41, 8.82]),
        center: [0, 0],
        zoom: 1
      })
    });
  </script>

</body>
</html>